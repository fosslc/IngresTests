/*
  Copyright (c) 2010 Ingres Corporation

  Test Name     : utl101.sep
  Suite         : be!datatypes
  Focus         : Ingres 10.0 New Data Type:  BOOLEAN with utilities
		  statdump, optimizedb, sysmod

  Databases     : SEPPARAMDB (utildb)
  Tables        : utl101_t1
  Indexes	:
  Filled Files  : 
  Copied Files  : 
  Input Files   : utl101_t1.dat
  Output Files  : utl101statdmp.txt
  Prerequisites : None 
  Run as user   : testenv
  Summary       : This test will create statistics on a table with three
		  BOOLEAN columns, and then print them to a file using statdump.
		  A select from system catalog iihistograms will verify the
		  statistics have been successfully created.  Lastly, run sysmod
		  on the utildb database.

  Known Issues  : None.

  History       : 01-Mar-2010 (vande02) Created.
                : 05-May-2010 (vande02) Added utl101mask.tmp to ignore benign
                                        version numbers/order from sysmod output
					which can change platform by platform.
                : 10-May-2010 (vande02) Updating sysmod canon one more time.
                : 12-May-2010 (vande02) Added alternate canon for sysmod.
*/
? fill utl101_t1.dat
!!
!!
? fill utl101mask.tmp
!!
!!
? fill utl101mask.tmp
!!
s/APPLICATION_DEVELOPMENT_[0-9] version [0-9]/APPLICATION_DEVELOPMENT_MNUM version MNUM/g
!!
? sepset sed utl101mask.tmp
<<
>>
? cp @file(ing_tst,be,util,data,utl101_t1.dat) utl101_t1.dat 
<<
>>
? statdump -zdl SEPPARAMDB
<<
~
>>
? sql -s SEPPARAMDB
<<
>>
* drop utl101_t1\g
<<
~
>>
* create table utl101_t1(id integer not null, active boolean not null,-
  retired boolean not null, deceased boolean null) with nojournaling\g 
<<
>>
* copy table utl101_t1(id=c0tab, active=varchar(0)tab, retired=varchar(0)tab,-
  deceased=varchar(0)nl with null(']^NULL^['), nl=d0nl)-
  from 'utl101_t1.dat'\g
<<
(101 rows)
>>
* select count(*) from utl101_t1 where active = FALSE\g 
<<
+-------------+
|col1         |
+-------------+
|           20|
+-------------+
(1 row)
>>
* select count(*) from utl101_t1 where retired = 'false' \g 
<<
+-------------+
|col1         |
+-------------+
|           10|
+-------------+
(1 row)
>>
* select count(*) from utl101_t1 where deceased < true \g 
<<
+-------------+
|col1         |
+-------------+
|            6|
+-------------+
(1 row)
>>
* select count(*) from utl101_t1 where deceased IS NULL \g 
<<
+-------------+
|col1         |
+-------------+
|            2|
+-------------+
(1 row)
>>
* \q
<<
>>
? optimizedb SEPPARAMDB -rutl101_t1
<<
>>
? statdump -o utl101statdmp.txt SEPPARAMDB-
  -rutl101_t1 -aactive -aretired -adeceased
<<
>>
? sql -s SEPPARAMDB
<<
>>
* select distinct table_name, column_name from iihistograms-
  where table_name like 'utl101_t1%' order by 2\g
<<

+--------------------------------+--------------------------------+
|table_name                      |column_name                     |
+--------------------------------+--------------------------------+
|utl101_t1                       |active                          |
|utl101_t1                       |deceased                        |
|utl101_t1                       |id                              |
|utl101_t1                       |retired                         |
+--------------------------------+--------------------------------+
(4 rows)
>>
* \q
<<
>>
? type utl101statdmp.txt
<<

*** statistics for database utildb version: 01000
*** table utl101_t1 rows:101 pages:3 overflow pages:0
*** column active of type boolean (length:0, scale:0, not_nullable)
date:2010_03_02 00:11:07 GMT  unique values:2.000
repetition factor:50.5000000      unique flag:N complete flag:0
domain:0 histogram cells:3 null count:0.0000000       value length:1
cell:    0    count:0.0000000          repf:0.0000000          value:TRUE
cell:    1    count:0.1980198          repf:20.0000000         value:FALSE
cell:    2    count:0.8019802          repf:81.0000000         value:TRUE


*** statistics for database utildb version: 01000
*** table utl101_t1 rows:101 pages:3 overflow pages:0
*** column retired of type boolean (length:0, scale:0, not_nullable)
date:2010_03_02 00:11:07 GMT  unique values:2.000
repetition factor:50.5000000      unique flag:N complete flag:0
domain:0 histogram cells:3 null count:0.0000000       value length:1
cell:    0    count:0.0000000          repf:0.0000000          value:TRUE
cell:    1    count:0.0990099          repf:10.0000000         value:FALSE
cell:    2    count:0.9009901          repf:91.0000000         value:TRUE


*** statistics for database utildb version: 01000
*** table utl101_t1 rows:101 pages:3 overflow pages:0
*** column deceased of type boolean (length:0, scale:0, nullable)
date:2010_03_02 00:11:07 GMT  unique values:3.000
repetition factor:33.6666679      unique flag:N complete flag:0
domain:0 histogram cells:3 null count:0.0198020       value length:1
cell:    0    count:0.0000000          repf:0.0000000          value:TRUE
cell:    1    count:0.0594059          repf:6.0000000          value:FALSE
cell:    2    count:0.9207921          repf:93.0000000         value:TRUE

>>
? sysmod SEPPARAMDB
<<
Sysmoding database 'utildb' . . .

  Modifying 'iiattribute' . . .
  Modifying 'iidevices' . . .
  Modifying 'iiindex' . . .
  Modifying 'iirelation' . . .
  Modifying 'iidbdepends' . . .
  Modifying 'iihistogram' . . .
  Modifying 'iiintegrity' . . .
  Modifying 'iiprotect' . . .
  Modifying 'iiqrytext' . . .
  Modifying 'iistatistics' . . .
  Modifying 'iitree' . . .
  Modifying 'iiprocedure' . . .
  Modifying 'iirule' . . .
  Modifying 'iievent' . . .
  Modifying 'iisynonym' . . .
  Modifying 'iidbms_comment' . . .
  Modifying 'iipriv' . . .
  Modifying 'iigw06_relation' . . .
  Modifying 'iigw06_attribute' . . .
  Modifying 'iikey' . . .
  Modifying 'iidefault' . . .
  Modifying 'iiprocedure_parameter' . . .
  Modifying 'iischema' . . .
  Modifying 'iisectype' . . .
  Modifying 'iisecalarm' . . .
  Modifying 'iiprivlist' . . .
  Modifying 'iirange' . . .
  Modifying 'iiextended_relation' . . .
  Modifying 'iidbcapabilities' . . .
  Modifying 'iisequence' . . .
  Modifying 'iidistscheme' . . .
  Modifying 'iidistcol' . . .
  Modifying 'iidistval' . . .
  Modifying 'iipartname' . . .
  Modifying front-end module PHYSICAL_DATA_MODELLING version 1 . . .
  Modifying front-end module METASCHEMA version 1 . . .
  Modifying front-end module CORE version 2 . . .
  Modifying front-end module APPLICATION_DEVELOPMENT_1 version 5 . . .
  Modifying front-end module APPLICATION_DEVELOPMENT_1 version 4 . . .
  Modifying front-end module APPLICATION_DEVELOPMENT_2 version 2 . . .
  Modifying front-end module APPLICATION_DEVELOPMENT_3 version 1 . . .
  Modifying front-end module APPLICATION_DEVELOPMENT_4 version 1 . . .

Sysmod of database 'utildb' completed successfully.
>>
<<
Sysmoding database 'utildb' . . .

  Modifying 'iiattribute' . . .
  Modifying 'iidevices' . . .
  Modifying 'iiindex' . . .
  Modifying 'iirelation' . . .
  Modifying 'iidbdepends' . . .
  Modifying 'iihistogram' . . .
  Modifying 'iiintegrity' . . .
  Modifying 'iiprotect' . . .
  Modifying 'iiqrytext' . . .
  Modifying 'iistatistics' . . .
  Modifying 'iitree' . . .
  Modifying 'iiprocedure' . . .
  Modifying 'iirule' . . .
  Modifying 'iievent' . . .
  Modifying 'iisynonym' . . .
  Modifying 'iidbms_comment' . . .
  Modifying 'iipriv' . . .
  Modifying 'iigw06_relation' . . .
  Modifying 'iigw06_attribute' . . .
  Modifying 'iikey' . . .
  Modifying 'iidefault' . . .
  Modifying 'iiprocedure_parameter' . . .
  Modifying 'iischema' . . .
  Modifying 'iisectype' . . .
  Modifying 'iisecalarm' . . .
  Modifying 'iiprivlist' . . .
  Modifying 'iirange' . . .
  Modifying 'iiextended_relation' . . .
  Modifying 'iidbcapabilities' . . .
  Modifying 'iisequence' . . .
  Modifying 'iidistscheme' . . .
  Modifying 'iidistcol' . . .
  Modifying 'iidistval' . . .
  Modifying 'iipartname' . . .
  Modifying front-end module PHYSICAL_DATA_MODELLING version 1 . . .
  Modifying front-end module METASCHEMA version 1 . . .
  Modifying front-end module CORE version 2 . . .
  Modifying front-end module APPLICATION_DEVELOPMENT_1 version 5 . . .
  Modifying front-end module APPLICATION_DEVELOPMENT_1 version 4 . . .
  Modifying front-end module APPLICATION_DEVELOPMENT_2 version 2 . . .
  Modifying front-end module APPLICATION_DEVELOPMENT_3 version 1 . . .

Sysmod of database 'utildb' completed successfully.
>>
? delete utl101statdmp.txt
<<
~
>>
