/*
  Copyright (c) 2010 Ingres Corporation

  Test Name     : dt96.sep
  Suite         : be!datatypes
  Focus         : Ingres 10.0 New Data Type:  BOOLEAN 

  Databases     : SEPPARAMDB1 (datatypedb)
  Tables        : dt96_t1
  Filled Files  : 
  Copied Files  : 
  Output Files  :
  Prerequisites : None 
  Run as user   : testenv
  Summary       : Basic functionality test: 
		    * Valid character conversion functions from BOOLEAN values.
		    * Valid CASTs of BOOLEAN literals and string values AS
		      valid character types.
		    * Valid CASTs with the function AS BOOLEAN.
		    * Conversion of BOOLEAN values to valid character
		      types using BOOLEAN columns.
		    * Conversion of BOOLEAN column to valid character types
		      in select list and CAST AS BOOLEAN in the predicate.
		    * BOOLEAN() conversion function from valid character types.
		    * BOOLEAN() conversion trims white space.


  Known Issues  : None.

  History       : 11-Jan-2010 (vande02) Created.
		: 22-Feb-2010 (vande02) Added BOOLEAN() character data types.
                : 22-Apr-2010 (vande02) Corrected SEPPARAMDB to SEPPARAMDB1.
                : 23-Apr-2010 (vande02) SD issue 141968 fixed, added more SQL.
*/
? sql -s SEPPARAMDB1 
<<
>>
* drop dt96_t1, dt96_t2\g
<<
~
>>
* create table dt96_t1 (c1_id tinyint, c2_bool boolean)\g
<<
>>
* insert into dt96_t1 values (1, true)\g
<<
(1 row)
>>
* insert into dt96_t1 values (2, false)\g
<<
(1 row)
>>
* insert into dt96_t1 values (3, null)\g
<<
(1 row)
>>
* insert into dt96_t1 values (4, null)\g
<<
(1 row)
>>
* insert into dt96_t1 values (5, 'true')\g
<<
(1 row)
>>
* insert into dt96_t1 values (6, 'false')\g
<<
(1 row)
>>
* insert into dt96_t1 values (7, 1)\g
<<
(1 row)
>>
* insert into dt96_t1 values (8, 0)\g
<<
(1 row)
>>
* select c1_id,c2_bool from dt96_t1 order by 1\g
<<
+------+-----+
|c1_id |c2_bo|
+------+-----+
|     1|TRUE |
|     2|FALSE|
|     3|     |
|     4|     |
|     5|TRUE |
|     6|FALSE|
|     7|TRUE |
|     8|FALSE|
+------+-----+
(8 rows)
>>
/*
Valid character data type conversion functions from BOOLEAN values.
Verifying this syntax does not require actual rows from a table.
*/
* select c(true)\g
<<
+------+
|col1  |
+------+
|T     |
+------+
(1 row)
>>
* select c(false)\g
<<
+------+
|col1  |
+------+
|F     |
+------+
(1 row)
>>
* select char(TRUE)\g
<<
+------+
|col1  |
+------+
|T     |
+------+
(1 row)
>>
* select char(FALSE)\g
<<
+------+
|col1  |
+------+
|F     |
+------+
(1 row)
>>
* select text('true')\g
<<
+------+
|col1  |
+------+
|true  |
+------+
(1 row)
>>
* select text('FALSE')\g
<<
+------+
|col1  |
+------+
|FALSE |
+------+
(1 row)
>>
* select varchar('TRUE')\g
<<
+------+
|col1  |
+------+
|TRUE  |
+------+
(1 row)
>>
* select varchar('false')\g
<<
+------+
|col1  |
+------+
|false |
+------+
(1 row)
>>
* select c(varchar(TRUE))\g
<<
+------+
|col1  |
+------+
|T     |
+------+
(1 row)
>>
* select c(varchar(FALSE))\g
<<
+------+
|col1  |
+------+
|F     |
+------+
(1 row)
>>
/*
Valid CASTs of BOOLEAN literals and string values AS valid character types.
Verifying this syntax does not require actual rows from a table.
*/
* select cast(TRUE as c)\g
<<
+------+
|col1  |
+------+
|T     |
+------+
(1 row)
>>
* select cast(false as c)\g
<<
+------+
|col1  |
+------+
|F     |
+------+
(1 row)
>>
* select cast('false' as c)\g
<<
+------+
|col1  |
+------+
|false |
+------+
(1 row)
>>
* select cast('true' as c)\g
<<
+------+
|col1  |
+------+
|true  |
+------+
(1 row)
>>
* select cast(TRUE as char(4))\g
<<
+------+
|col1  |
+------+
|TRUE  |
+------+
(1 row)
>>
* select cast(false as char(5))\g
<<
+------+
|col1  |
+------+
|FALSE |
+------+
(1 row)
>>
* select cast('true' as char(4))\g
<<
+------+
|col1  |
+------+
|true  |
+------+
(1 row)
>>
* select cast('false' as char(5))\g
<<
+------+
|col1  |
+------+
|false |
+------+
(1 row)
>>
* select cast('false' as text(5))\g
<<
+------+
|col1  |
+------+
|false |
+------+
(1 row)
>>
* select cast(true as text(5))\g
<<
+------+
|col1  |
+------+
|TRUE  |
+------+
(1 row)
>>
* select cast('TRUE' as varchar(4))\g
<<
+------+
|col1  |
+------+
|TRUE  |
+------+
(1 row)
>>
* select cast(false as varchar(5))\g
<<
+------+
|col1  |
+------+
|FALSE |
+------+
(1 row)
>>
/*
Valid CASTs with the function AS BOOLEAN.
Verifying this syntax does not require actual rows from a table.
*/
* select cast(0 as boolean)\g
<<
+-----+
|col1 |
+-----+
|FALSE|
+-----+
(1 row)
>>
* select cast(1 as boolean)\g
<<
+-----+
|col1 |
+-----+
|TRUE |
+-----+
(1 row)
>>
* select cast('false' as boolean)\g
<<
+-----+
|col1 |
+-----+
|FALSE|
+-----+
(1 row)
>>
* select cast('TRUE' as boolean)\g
<<
+-----+
|col1 |
+-----+
|TRUE |
+-----+
(1 row)
>>
* select cast(NULL as boolean)\g
<<
+-----+
|col1 |
+-----+
|     |
+-----+
(1 row)
>>
* select cast(FALSE as boolean)\g
<<
+-----+
|col1 |
+-----+
|FALSE|
+-----+
(1 row)
>>
* select cast(TRUE as boolean)\g
<<
+-----+
|col1 |
+-----+
|TRUE |
+-----+
(1 row)
>>
* select cast(unknown as boolean)\g
<<
E_US0837 line 1, FROM clause is mandatory when a column ('unknown') has
    been specified in the target list.
    (Fri Apr 23 12:58:09 2010)
>>
* select c1_id,c2_bool,c(true) from dt96_t1 order by 1\g
<<
+------+-----+------+
|c1_id |c2_bo|col3  |
+------+-----+------+
|     1|TRUE |T     |
|     2|FALSE|T     |
|     3|     |T     |
|     4|     |T     |
|     5|TRUE |T     |
|     6|FALSE|T     |
|     7|TRUE |T     |
|     8|FALSE|T     |
+------+-----+------+
(8 rows)
>>
* select c1_id,c2_bool,char(FALSE) from dt96_t1 order by 1\g
<<
+------+-----+------+
|c1_id |c2_bo|col3  |
+------+-----+------+
|     1|TRUE |F     |
|     2|FALSE|F     |
|     3|     |F     |
|     4|     |F     |
|     5|TRUE |F     |
|     6|FALSE|F     |
|     7|TRUE |F     |
|     8|FALSE|F     |
+------+-----+------+
(8 rows)
>>
* select c1_id,c2_bool,varchar('TRUE') from dt96_t1 where c1_id = 8\g
<<
+------+-----+------+
|c1_id |c2_bo|col3  |
+------+-----+------+
|     8|FALSE|TRUE  |
+------+-----+------+
(1 row)
>>
* select c1_id,c2_bool,varchar('false') from dt96_t1 where c1_id = 7\g
<<
+------+-----+------+
|c1_id |c2_bo|col3  |
+------+-----+------+
|     7|TRUE |false |
+------+-----+------+
(1 row)
>>
* select c1_id,c2_bool,text(TRUE) from dt96_t1 where c1_id = 8\g
<<
+------+-----+------+
|c1_id |c2_bo|col3  |
+------+-----+------+
|     8|FALSE|T     |
+------+-----+------+
(1 row)
>>
* select c1_id,c2_bool,text('true') from dt96_t1 where c1_id = 7\g
<<
+------+-----+------+
|c1_id |c2_bo|col3  |
+------+-----+------+
|     7|TRUE |true  |
+------+-----+------+
(1 row)
>>
* select c1_id,c2_bool,text(1) from dt96_t1 where c1_id = 6\g
<<
+------+-----+------+
|c1_id |c2_bo|col3  |
+------+-----+------+
|     6|FALSE|1     |
+------+-----+------+
(1 row)
>>
* select c1_id,c2_bool,varchar(0) from dt96_t1 where c1_id = 5\g
<<
+------+-----+------+
|c1_id |c2_bo|col3  |
+------+-----+------+
|     5|TRUE |0     |
+------+-----+------+
(1 row)
>>
* select c1_id,char(c2_bool,5) from dt96_t1 where c2_bool IS NOT NULL\g
<<
+------+------+
|c1_id |col2  |
+------+------+
|     1|TRUE  |
|     2|FALSE |
|     5|TRUE  |
|     6|FALSE |
|     7|TRUE  |
|     8|FALSE |
+------+------+
(6 rows)
>>
* select c1_id,varchar(c2_bool,5) from dt96_t1 order by 1\g
<<
+------+------+
|c1_id |col2  |
+------+------+
|     1|TRUE  |
|     2|FALSE |
|     3|      |
|     4|      |
|     5|TRUE  |
|     6|FALSE |
|     7|TRUE  |
|     8|FALSE |
+------+------+
(8 rows)
>>
/*
Conversion of BOOLEAN column to valid character types in select list and
CAST AS BOOLEAN in the predicate.
*/
* select c1_id,text(c2_bool,20) from dt96_t1-
  where c2_bool = cast(1 AS BOOLEAN)\g
<<
+------+--------------------+
|c1_id |col2                |
+------+--------------------+
|     1|TRUE                |
|     5|TRUE                |
|     7|TRUE                |
+------+--------------------+
(3 rows)
>>
* select c1_id,c(c2_bool,20) from dt96_t1-
  where c2_bool != cast(1 AS BOOLEAN)\g
<<
+------+--------------------+
|c1_id |col2                |
+------+--------------------+
|     2|FALSE               |
|     6|FALSE               |
|     8|FALSE               |
+------+--------------------+
(3 rows)
>>
* select c1_id,text(c2_bool,20) from dt96_t1-
  where c2_bool = cast(0 as boolean)\g
<<
+------+--------------------+
|c1_id |col2                |
+------+--------------------+
|     2|FALSE               |
|     6|FALSE               |
|     8|FALSE               |
+------+--------------------+
(3 rows)
>>
* select c1_id,text(c2_bool,20) from dt96_t1-
  where c2_bool != cast('false' AS BOOLEAN)\g
<<
+------+--------------------+
|c1_id |col2                |
+------+--------------------+
|     1|TRUE                |
|     5|TRUE                |
|     7|TRUE                |
+------+--------------------+
(3 rows)
>>
* select c1_id,text(c2_bool,20) from dt96_t1-
  where c2_bool < cast('true' AS BOOLEAN)\g
<<
+------+--------------------+
|c1_id |col2                |
+------+--------------------+
|     2|FALSE               |
|     6|FALSE               |
|     8|FALSE               |
+------+--------------------+
(3 rows)
>>
* select c1_id,text(c2_bool,20) from dt96_t1 where c2_bool IS NULL\g
<<
+------+--------------------+
|c1_id |col2                |
+------+--------------------+
|     3|                    |
|     4|                    |
+------+--------------------+
(2 rows)
>>
* select cast(c2_bool as boolean) from dt96_t1\g
<<
+-----+
|col1 |
+-----+
|TRUE |
|FALSE|
|     |
|     |
|TRUE |
|FALSE|
|TRUE |
|FALSE|
+-----+
(8 rows)
>>
* select c1_id,text(c2_bool,20) from dt96_t1 where-
  c2_bool=cast(true as boolean)\g
<<

+------+--------------------+
|c1_id |col2                |
+------+--------------------+
|     1|TRUE                |
|     5|TRUE                |
|     7|TRUE                |
+------+--------------------+
(3 rows)
>>
* select c1_id,text(c2_bool,20) from dt96_t1 where-
  c2_bool=cast(false as boolean)\g
<<

+------+--------------------+
|c1_id |col2                |
+------+--------------------+
|     2|FALSE               |
|     6|FALSE               |
|     8|FALSE               |
+------+--------------------+
(3 rows)
>>
* select cast(c2_bool as char(5)), count(*) from dt96_t1-
  group by c2_bool order by 1\g
<<
+------+-------------+
|col1  |col2         |
+------+-------------+
|FALSE |            3|
|TRUE  |            3|
|      |            2|
+------+-------------+
(3 rows)
>>
/*
BOOLEAN conversion function with valid character types.
*/
* create table dt96_t2 (id int1, c2_c c5, c3_char char(5),-
  c4_varchar varchar(5), c5_text text(5)) with page_size=4096\g
<<
>>
* insert into dt96_t2 values (10,'false','false','false','false')\g
<<
(1 row)
>>
* insert into dt96_t2 values (20,'TRUE','TRUE','TRUE','TRUE')\g
<<
(1 row)
>>
* insert into dt96_t2 values (30,null,null,null,null)\g
<<
(1 row)
>>
* insert into dt96_t2 values (40,'true','true','true','true')\g
<<
(1 row)
>>
* insert into dt96_t2 values (50,'FALSE','FALSE','FALSE','FALSE')\g
<<
(1 row)
>>
* insert into dt96_t2 values (60,'FALSE  ','false  ','TRUE   ','true   ')\g
<<
(1 row)
>>
* select * from dt96_t2 order by id\g
<<

+------+------+------+------+------+
|id    |c2_c  |c3_cha|c4_var|c5_tex|
+------+------+------+------+------+
|    10|false |false |false |false |
|    20|TRUE  |TRUE  |TRUE  |TRUE  |
|    30|      |      |      |      |
|    40|true  |true  |true  |true  |
|    50|FALSE |FALSE |FALSE |FALSE |
|    60|FALSE |false |TRUE  |true  |
+------+------+------+------+------+
(6 rows)
>>
* select id, boolean(c2_c), boolean(c3_char), boolean(c4_varchar),-
  boolean(c5_text) from dt96_t2 order by id\g
<<

+------+-----+-----+-----+-----+
|id    |col2 |col3 |col4 |col5 |
+------+-----+-----+-----+-----+
|    10|FALSE|FALSE|FALSE|FALSE|
|    20|TRUE |TRUE |TRUE |TRUE |
|    30|     |     |     |     |
|    40|TRUE |TRUE |TRUE |TRUE |
|    50|FALSE|FALSE|FALSE|FALSE|
|    60|FALSE|FALSE|TRUE |TRUE |
+------+-----+-----+-----+-----+
(6 rows)
>>
/*
BOOLEAN() conversion should just trim the white space after the character
columns are increased from a length of 5 to 7 and spaces are to the right
of the BOOLEAN values.
*/
* alter table dt96_t2 alter column c2_c c7\g
<<
>>
* alter table dt96_t2 alter column c3_char char(7)\g
<<
>>
* alter table dt96_t2 alter column c4_varchar varchar(7)\g
<<
>>
* alter table dt96_t2 alter column c5_text text(7)\g
<<
>>
* insert into dt96_t2 values-
  (70,'true      ','TRUE      ','false     ','FALSE     ')\g
<<
(1 row)
>>
* select * from dt96_t2 order by id\g
<<

+------+-------+-------+-------+-------+
|id    |c2_c   |c3_char|c4_varc|c5_text|
+------+-------+-------+-------+-------+
|    10|false  |false  |false  |false  |
|    20|TRUE   |TRUE   |TRUE   |TRUE   |
|    30|       |       |       |       |
|    40|true   |true   |true   |true   |
|    50|FALSE  |FALSE  |FALSE  |FALSE  |
|    60|FALSE  |false  |TRUE   |true   |
|    70|true   |TRUE   |false  |FALSE  |
+------+-------+-------+-------+-------+
(7 rows)
>>
* select id, boolean(c2_c), boolean(c3_char), boolean(c4_varchar),-
  boolean(c5_text) from dt96_t2 order by id\g
<<

+------+-----+-----+-----+-----+
|id    |col2 |col3 |col4 |col5 |
+------+-----+-----+-----+-----+
|    10|FALSE|FALSE|FALSE|FALSE|
|    20|TRUE |TRUE |TRUE |TRUE |
|    30|     |     |     |     |
|    40|TRUE |TRUE |TRUE |TRUE |
|    50|FALSE|FALSE|FALSE|FALSE|
|    60|FALSE|FALSE|TRUE |TRUE |
|    70|TRUE |TRUE |FALSE|FALSE|
+------+-----+-----+-----+-----+
(7 rows)
>>
* \q
<<
>>
